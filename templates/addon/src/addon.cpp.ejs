#include <v8.h>
#include <node.h>

using namespace v8;
using namespace node;

<% addon.objects.forEach(function(obj) { %>
#include "<%- obj.name %>.h"
<% }); %>

// module.exports = ...
<% addon.objects.forEach(function(obj) { %>
void <%- obj.name%>Init(Handle<Object> exports, Handle<Object> module) {
  exports->Set(String::NewSymbol("<%- obj.name %>"), FunctionTemplate::New(<%- obj.name %>)->GetFunction());
}
<% }); %>


extern "C" {
  static void init(Handle<Object> exports, Handle<Object> module) {
    <% addon.objects.forEach(function(obj) { %>
    <%- obj.name %>::<%- obj.name %>Init(exports, module);
    <% }); %>
  }

  NODE_MODULE(<%- addon.name %>, init);
}

